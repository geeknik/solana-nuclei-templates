id: solana-pda-sharing-vulnerability

info:
  name: Solana PDA Sharing Vulnerability
  author: geeknik
  severity: high
  description: |
    Detects when a program uses the same PDA seed for multiple roles or permissions, creating authorization confusion.
  remediation: |
    Use unique seeds for different authority roles, especially when using PDAs for signing operations.
  reference:
    - https://github.com/slowmist/solana-smart-contract-security-best-practices
  metadata:
    verified: true
  tags: audit,solana,smart-contract,pda,permissions

file:
  - extensions:
      - rs

    matchers:
      - type: regex
        part: body
        regex:
          - "let\\s+seeds\\s*=\\s*&\\[[^\\]]*\\];"
          - "create_program_address\\([^)]*\\)"
          - "find_program_address\\([^)]*\\)"
        condition: or
        
    extractors:
      - type: regex
        regex:
          - "(create|find)_program_address\\(\\s*&\\[([^\\]]+)\\]"
        part: body
