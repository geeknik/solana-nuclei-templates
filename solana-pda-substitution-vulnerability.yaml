id: solana-pda-substitution-vulnerability

info:
  name: Solana PDA Substitution Vulnerability
  author: geeknik
  severity: high
  description: |
    Detects when a Solana program uses Program Derived Addresses (PDAs) without proper validation, allowing an attacker to potentially substitute an unofficial account.
  remediation: |
    Create PDAs based on unique accounts and verify PDA derivation in your code using find_program_address() and checking against expected bump seeds.
  reference:
    - https://github.com/slowmist/solana-smart-contract-security-best-practices
  metadata:
    verified: true
  tags: audit,solana,smart-contract,pda,validation

file:
  - extensions:
      - rs

    matchers:
      - type: regex
        part: body
        regex:
          - "Pubkey::create_program_address\\("
        condition: and
        negative:
          - "find_program_address"
          - "expected_bump"
